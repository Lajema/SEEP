---
title: "R Notebook"
author: "John Kamau"
date: "27/11/2019"
output:
  word_document: default
  html_notebook: default
  pdf_document: default
  html_document:
    df_print: paged
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE,fig.width = 10,fig.height = 7)
options(scipen=999)
```

```{r}
setwd('D:\\Kamau Lift\\SEEP\\Group Meeting')
library(readxl)
library(data.table)
library(dplyr)
library(tidyr)
library(knitr,kableExtra)
library(formattable)
library(ggplot2)
source('theme.R')
colors <- c("#118467", "#A9711E", "#6D847A", "#BB8755", "#82ACA0", "#9C7F61",
            "#D88523", "#83A593", "#E6A168", "#9DD0C0", "#BE9D7C", "#A2C8B9",
            "#EBCABA", "#A1DBD3")
combined <- read_excel("D:/Kamau Lift/SEEP/combined.xlsx")
setDT(combined)
M1<-combined[,grep("^ID$|Country|SEEP_GROUPMEETING 1",names(combined)),with =F]
M2<-combined[,grep("^ID$|Country|SEEP_GROUPMEETING 2",names(combined)),with =F]
M3<-combined[,grep("^ID$|Country|SEEP_GROUPMEETING 3",names(combined)),with =F]
# M1 <- read_excel("D:/Kamau Lift/SEEP/Group Meeting/SEEPGroupMeeting1_2019_13_08_13_53_New1.xlsx")
# M2 <- read_excel("D:/Kamau Lift/SEEP/Group Meeting/SEEPGroupMeeting2_2019_13_08_13_56_new.xlsx")
# M3 <- read_excel("D:/Kamau Lift/SEEP/Group Meeting/SEEPGroupMeeting_3_2019_13_08_13_58_new.xlsx")

# setDT(M1)
# setDT(M2)
# setDT(M3)
```

# Q6	Did the meeting start late?

```{r}
library(janitor)
x =M1[,grep("Country|Q_6",names(M1)),with =F]
names(x)<-c("Country","Q_4")
x$Group = 1
x1=M2[,grep("Country|Q_4$",names(M2)),with =F]
x1$Group = 2
x2 =M3[,grep("Country|Q_4$",names(M3)),with =F]
x2$Group = 3
B<-rbind(x,x1,use.names=FALSE )
B<-rbind(B,x2,use.names=FALSE )
B[B$Country=="-"]<-NA
B[,Late:=ifelse(Q_4==1,"Yes",ifelse(Q_4==2,"No",NA))]
B$Late<-factor(B$Late,levels = c("Yes","No","Respondents","Percentage"))
B<-B%>%drop_na() %>%  group_by(Country,Late,Group)  %>% tally() %>% summarise(Mean = mean(n)) %>% dcast(Late~Country)
rbind(B,c("Respondents",colSums(B[,c(2:3)])),fill=TRUE)[1:3,] %>% kable()
per <- B%>%  adorn_percentages('col')
rbind(per,c("Percentage",colSums(per[,c(2:3)])),fill=TRUE)[1:3,] %>% kable()

```

# Q7	How many minutes too late did the meeting start?

```{r}
x =M1[,grep("Country|Q_7",names(M1)),with =F]
names(x)<-c("Country","Meeting1")
x1=M2[,grep("Country|Q_5$",names(M2)),with =F]
names(x1)<-c("Country","Meeting2")
x2 =M3[,grep("Country|Q_5$",names(M3)),with =F]
names(x2)<-c("Country","Meeting3")
print("G1")
x[x$Country=="-"]<-NA
B<-rbind(x,x1,use.names=FALSE )
B<-rbind(B,x2,use.names=FALSE )
B[,Meeting1:=ifelse(Meeting1<0,NA,Meeting1)] %>%drop_na() %>%   ggplot(aes(y=Meeting1,x =Country))+geom_boxplot(fill =colors[1])+theme1+scale_fill_manual(values = colors)+labs(title ="How many minutes too late did the meeting start? SEEP-GM-07",y ="Minutes",x="Country")+scale_y_continuous(breaks=seq(0,250,10))+coord_cartesian(ylim = c(0,120))+geom_jitter(alpha =0.2,color = colors[5])
B %>% group_by(Country) %>% tally() %>% mutate(n=n/3)
```

# Q8	What was the reason/were the reasons the meeting started late?	(Multiple Selection)


```{r}
x =M1[,grep("Country|A_8",names(M1)),with =F]
x$G <-"G1"
x1=M2[,grep("Country|A_6",names(M2)),with =F][,c(1:7)]
x1$G <-"G2"
x2 =M3[,grep("Country|A_6",names(M3)),with =F][,c(1:7)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
y <- copy(B)
names(B)<-c("Country","Chairperson or other committee members were late","Members were late","The location was not ready yet","People were first talking and discussing","Nobody paid attention to the time","Other (specify)","G")
B.melt<-melt(B,id.vars =c("Country","G"))
B.melt[B.melt$Country=="-"]<-NA
B.melt[B.melt$value==-1]<-0
#B.melt[,Late:=ifelse(value==1,"Chairperson or other committee members were late",ifelse(value==2,"Members were late",ifelse(value==3,"The location was not ready yet",ifelse(value==4,"People were first talking and discussing",ifelse(value==5,"Nobody paid attention to the time",ifelse(value==6,"Other (specify)",NA))))))]
B.melt$variable <-factor(B.melt$variable,levels = c("Chairperson or other committee members were late","Members were late","The location was not ready yet","People were first talking and discussing","Nobody paid attention to the time","Other (specify)","Respondents","Percentage"))
B<-B.melt %>% drop_na() %>% group_by(Country,variable,G)  %>% dcast(variable~Country,fun =sum) %>% mutate(Mali = Mali/3,Uganda =Uganda/3)
#rbind(B,c("Respondents",colSums(B[,c(2:7)],na.rm = T))) %>% kable()
B %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
#rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
per %>% kable()
y %>% group_by(Country) %>% tally() %>% mutate(n =n/3)

```

# Q9	Did the meeting start with a specific ritual, like a prayer, a song, a speech?	(Multiple Selection)

```{r}
x =M1[,grep("Country|A_9",names(M1)),with =F]
x$G <-"G1"
x1=M2[,grep("Country|A_7",names(M2)),with =F][,c(1:6)]
x1$G <-"G2"
x2 =M3[,grep("Country|A_7",names(M3)),with =F][,c(1:6)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
names(B)<-c("Country","A song or dance","A prayer","A speech","Reciting group rules/constitution","Other (specify)","G")
B.melt<-melt(B,id.vars =c("Country","G"))
B.melt[B.melt$Country=="-"]<-NA
#B.melt[,Ritual:=ifelse(value==1,"A song or dance",ifelse(value==2,"A prayer",ifelse(value==3,"A speech",ifelse(value==4,"Reciting group rules/constitution",ifelse(value==5,"Other (specify)",NA)))))]
B.melt$variable <-factor(B.melt$variable,levels =c("A song or dance","A prayer","A speech","Reciting group rules/constitution","Other (specify)","Respondents",'Percentage'))

B<-B.melt %>% drop_na() %>% group_by(Country,variable,G) %>% dcast(variable~Country,fun =sum)
B %>% mutate(Mali =Mali/3,Uganda = Uganda/3) %>%  kable()
#rbind(B,c("Respondents",colSums(B[,c(2:7)],na.rm = T))) %>% kable()

per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()

```

# Q10	Did the meeting have a round of questions or comment where each member got a chance to speak?	

```{r}
x =M1[,grep("Country|Q_10",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_8",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_8",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_10","G")
B[,Questions:=ifelse(Q_10==1,"Yes",ifelse(Q_10==2,"No",ifelse(Q_10==3,"Other (specify)",ifelse(Q_10==4,"I don’t know",NA))))]
B$Questions<-factor(B$Questions,levels=c("Yes","No","Other (specify)","I don’t know","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Questions,G) %>% dcast(Questions~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# Q11	How were the savings collected?	

```{r}
x =M1[,grep("Country|Q_11",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_9",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_9",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_11","G")
B[,Savings:=ifelse(Q_11==1,"One member was called at a time",ifelse(Q_11==2,"All members put their savings at the same time",ifelse(Q_11==3,"It was supposed to be one member at a time but it was chaotic and some doing at same time",ifelse(Q_11==4,"Other (specify)",NA))))]
B$Savings<-factor(B$Savings,levels=c("One member was called at a time","All members put their savings at the same time",
"It was supposed to be one member at a time but it was chaotic and some doing at same time","Other (specify)","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Savings,G) %>% dcast(Savings~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# Others in Q_11

```{r}
x =M1[,grep("Country|Q_11",names(M1)),with =F]#[,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_9",names(M2)),with =F]#[,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_9",names(M3)),with =F]#[,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
names(B)<-c("Country","D1","Others",'G')
B[,Others:=tolower(Others)] %>% group_by(Country,Others) %>% tally() %>% kable()
```


# Q12	Did each savings amount get counted?	

```{r}
x =M1[,grep("Country|Q_12",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_10",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_10",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_12","G")
B[,Savings:=ifelse(Q_12==1,"Yes, each savings amount got counted and the total was announced by a money counter",ifelse(Q_12==2,"Yes, each savings amount got counted but total not announced",ifelse(Q_12==3,"No, savings was not counted but put in view of others without counting",ifelse(Q_12==4,"No, savings was not counted and not in view of others",ifelse(Q_12==5,"Other (specify)",NA)))))]
B$Savings<-factor(B$Savings,levels=c("Yes, each savings amount got counted and the total was announced by a money counter",
"Yes, each savings amount got counted but total not announced","No, savings was not counted but put in view of others without counting","No, savings was not counted and not in view of others","Other (specify)","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Savings,G)  %>% dcast(Savings~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# Q14	How were the savings recorded?	

```{r}
x =M1[,grep("Country|Q_14",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_12",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_12",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_14","G")
B[,Savings:=ifelse(Q_14==1,"Written record of each member’s savings",ifelse(Q_14==2,"Non-written system for each members’s savings.",ifelse(Q_14==3,"Some written system but only for total",ifelse(Q_14==4,"Memory based system but only for total",ifelse(Q_14==5,"Other (specify)",NA)))))]
B$Savings<-factor(B$Savings,levels=c("Written record of each member’s savings","Non-written system for each members’s savings.","Some written system but only for total","Memory based system but only for total","Other (specify)","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Savings,G)%>% dcast(Savings~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```
```{r}
x =M1[,grep("Country|Q_14",names(M1)),with =F]#[,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_12",names(M2)),with =F]#[,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_12",names(M3)),with =F]#[,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
names(B)<-c("Country","D1","Others",'G')
B %>% group_by(Country,Others) %>% count() %>% kable()
```


# Q15	Do members have an individual pass-book?	

```{r}
x =M1[,grep("Country|Q_15",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_13",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_13",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_15","G")
B[,Passbook:=ifelse(Q_15==1,"Yes, and they keep it themselves and bring it to the meeting",ifelse(Q_15==2,"Yes, but it is kept in the group",ifelse(Q_15==3,"No, no passbooks",ifelse(Q_15==4,"Other (specify)",NA))))]
B$Passbook<-factor(B$Passbook,levels=c("Yes, and they keep it themselves and bring it to the meeting","Yes, but it is kept in the group","No, no passbooks","Other (specify)","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Passbook,G) %>% dcast(Passbook~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# Q16	Did the savings get recorded in the individual pass-books?	


```{r}
x =M1[,grep("Country|Q_16",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_14",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_14",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_16","G")
B[,Passbook:=ifelse(Q_16==1,"Yes, with stamps for each share bought",ifelse(Q_16==2,"Yes, with a pen indicating each share bought",ifelse(Q_16==3,"Yes, amounts written out",ifelse(Q_16==4,"Other (specify)",NA))))]
B$Passbook<-factor(B$Passbook,levels=c("Yes, with stamps for each share bought","Yes, with a pen indicating each share bought","Yes, amounts written out","Other (specify)","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Passbook,G)  %>% dcast(Passbook~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# Q17	Did any of the group-members not save at all? How many did not save at all?	

```{r,fig.height =8}
x =M1[,grep("Country|Q_17",names(M1)),with =F]#[,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_15",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_15",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_17","G")
B %>% drop_na() %>% ggplot(aes(x=Country,y =Q_17))+geom_boxplot(fill =colors[1])+labs(title ="Did any of the group-members not save at all? How many did not save at all?	SEEP-GM-17",x ="Country",y ="Members who didnt save")+theme1+scale_fill_manual(values=colors)+scale_y_continuous(breaks=seq(0,65,5))+coord_cartesian(ylim =c(0,30))+geom_jitter(alpha =.2,color =colors[5])
 B %>% drop_na() %>% group_by(Country,G) %>% dcast(Country~G) %>% kable()
 kamau = data.frame(country = c('Uganda','Mali'),n = c(152,140))
 kamau %>% kable()
```

# Q18	Who did not save?	

```{r}
x =M1[,grep("Country|Q_18",names(M1)),with =F]#[,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_16",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_16",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_18","G")
B[,Non_savers:=ifelse(Q_18==1,"People who were absent",ifelse(Q_18==2,"People present",ifelse(Q_18==3,"Both absent and present people",NA)))]
B$Non_savers<-factor(B$Non_savers,levels =c("People who were absent","People present","Both absent and present people","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Non_savers,G)  %>% dcast(Non_savers~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# Q19	Was it considered against the rules that some people did not save?	

```{r}
x =M1[,grep("Country|Q_19",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_17",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_17",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_19","G")
B[,Non_savers:=ifelse(Q_19==1,"Yes, very much",ifelse(Q_19==2,"Yes, but no big deal made of it",ifelse(Q_19==3,"No, did not seem to",ifelse(Q_19==4,"No, it was clearly according to the rules, it is allowed to miss savings",ifelse(Q_19==5,"Other (specify)",NA)))))]
B$Non_savers<-factor(B$Non_savers,levels =c("Yes, very much","Yes, but no big deal made of it","No, did not seem to","No, it was clearly according to the rules, it is allowed to miss savings","Other (specify)","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Non_savers,G)  %>% dcast(Non_savers~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# Q20	Did the group give out loans at the meeting?	

```{r}
x =M1[,grep("Country|Q_20",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_18",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_18",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_20","G")
B[,Loans:=ifelse(Q_20==1,"Yes",ifelse(Q_20==2,"No",ifelse(Q_20==3,"Other (specify)",NA)))]
B$Loans<-factor(B$Loans,levels =c("Yes","No","Other (specify)","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Loans,G)  %>% dcast(Loans~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# Q22	Did people request loans or were they offered loans?	

```{r}
x =M1[,grep("Country|Q_22",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_20",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_20",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_22","G")
B[,Loans:=ifelse(Q_22==1,"Each member had the chance to request for a loan",ifelse(Q_22==2,"Specific members were asked whether they wanted a loan",ifelse(Q_22==3,"Specific members were assigned to get a loan",ifelse(Q_22==4,"Other (specify)",NA))))]
B$Loans<-factor(B$Loans,levels =c("Each member had the chance to request for a loan","Specific members were asked whether they wanted a loan","Specific members were assigned to get a loan","Other (specify)","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Loans,G)  %>% dcast(Loans~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# Others File

```{r}
x =M1[,grep("Country|Q_22",names(M1)),with =F]#[,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_20",names(M2)),with =F]#[,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_20",names(M3)),with =F]#[,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
namers<-c("Country" ,"D1","Others" , "G")
names(B)<-namers
B %>% drop_na() %>% group_by(Country,Others) %>% count()
```


# Q23	How were the loan allocated?	

```{r}
x =M1[,grep("Country|Q_23",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_21",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_21",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_23","G")
B[,Loans:=ifelse(Q_23==1,"There were more applicants for loans than available loans, so only some were successful at getting a loan",ifelse(Q_23==2,"All those requesting a loan received a loan",ifelse(Q_23==3,"Loans were given (it was assumed all wanted a loan)",ifelse(Q_23==4,"Loans were assigned (people were forced to take a loan)",ifelse(Q_23==5,"Other (specify)",NA)))))]
B$Loans<-factor(B$Loans,levels =c("There were more applicants for loans than available loans, so only some were successful at getting a loan","All those requesting a loan received a loan","Loans were given (it was assumed all wanted a loan)",
"Loans were assigned (people were forced to take a loan)","Other (specify)","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Loans,G)  %>% dcast(Loans~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# Q24	Did loan recipients need to meet financial criteria?	


```{r}
x =M1[,grep("Country|Q_24",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_22",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_22",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_24","G")
B[,Loans:=ifelse(Q_24==1,"Yes, record keeper verified that loans were within a specified multiple of member’s savings.",ifelse(Q_24==2,"Yes, loan eligibility depended on previous repayment or other criteria",ifelse(Q_24==3,"No, anyone could take a loan",ifelse(Q_24==4,"Other(specify)",NA))))]
B$Loans<-factor(B$Loans,levels =c("Yes, record keeper verified that loans were within a specified multiple of member’s savings.",
"Yes, loan eligibility depended on previous repayment or other criteria","No, anyone could take a loan","Other(specify)","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Loans,G)  %>% dcast(Loans~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# Q25	Were any rules about loan purpose applied or discussed?


```{r}
x =M1[,grep("Country|Q_25",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_23",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_23",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_25","G")
B[,Loans:=ifelse(Q_25==1,"Yes, loan purpose had to be productive",ifelse(Q_25==2,"Yes, loan purpose had to be useful (could be productive, emergencies, school fees...)",ifelse(Q_25==3,"loan purpose was mentioned but no criteria seemed required",ifelse(Q_25==4,"Loan purpose was not discussed",ifelse(Q_25==5,"Other (specify)",NA)))))]
B$Loans<-factor(B$Loans,levels =c("Yes, loan purpose had to be productive","Yes, loan purpose had to be useful (could be productive, emergencies, school fees...)",
"loan purpose was mentioned but no criteria seemed required","Loan purpose was not discussed","Other (specify)","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Loans,G)  %>% dcast(Loans~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# Q26	Who made the loan approval decision?	

```{r}
x =M1[,grep("Country|Q_26",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_24",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_24",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_26","G")
B[,Loans:=ifelse(Q_26==1,"The chairperson",ifelse(Q_26==2,"The committee",ifelse(Q_26==3,"The entire savings-group (voting)",ifelse(Q_26==4,"Just by discussion, nobody decided",ifelse(Q_26==5,"All requests automatically approved",ifelse(Q_26==6,"Other (specify)",NA))))))]
B$Loans<-factor(B$Loans,levels =c("The chairperson","The committee","The entire savings-group (voting)","Just by discussion, nobody decided","All requests automatically approved","Other (specify)","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Loans,G) %>% dcast(Loans~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# Q27	What is the interest rate charged for loans given at the meeting?	

```{r}
x =M1[,grep("^ID$|Country|Q_27",names(M1)),with =F]#[,c(1:2)]
x$G <-"G1"
x1=M2[,grep("^ID$|Country|Q_25",names(M2)),with =F]#[,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("^ID$|Country|Q_25",names(M3)),with =F]#[,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("ID","Country","Q_27","G")
B[,Q_27:=ifelse(Q_27<0,NA,Q_27)]
B %>% drop_na() %>% ggplot(aes(x=Country,y =Q_27))+geom_boxplot(fill =colors[1])+labs(title ="What is the interest rate charged for loans given at the meeting?	\n	SEEP-GM-27",x ="Country",y ="Interest rates as a Percentage")+theme1+scale_fill_manual(values=colors)+scale_y_continuous(breaks=seq(0,11,1))+geom_jitter(alpha =0.2,color =colors[5])
B$ID <-1:924
w<-B %>% arrange(Q_27)
B$ID<-factor(B$ID,levels=w$ID)

kamau %>% kable()
```

# Q28	how is that calculated?	

```{r}
x =M1[,grep("Country|Q_28",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_26",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_26",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_28","G")
B[,Calculated:=ifelse(Q_28==1,"One time, on amount borrowed.",ifelse(Q_28==2,"Monthly, for period borrowed.",ifelse(Q_28==3,"Recalculated each month on declining balance of loan",ifelse(Q_28==4,"Other:",NA))))]
B$Calculated<-factor(B$Calculated,levels =c("One time, on amount borrowed.","Monthly, for period borrowed.","Recalculated each month on declining balance of loan","Other:","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Calculated,G)  %>% dcast(Calculated~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# Q29	Did the group make any other decisions?

 ```{r}
 x =M1[,grep("Country|A_29",names(M1)),with =F][,c(1:4)]
 x$G <-"G1"
 x1=M2[,grep("Country|A_27",names(M2)),with =F]#[,c(1:2)]
# x1$G <-"G2"
# x2 =M3[,grep("Country|A_27",names(M3)),with =F]#[,c(1:2)]
# x2$G <-"G3"
# B <-rbind(x,x1,use.names=FALSE)
# B<-rbind(B,x2,use.names=FALSE)
# B[B$Country=="-"]<-NA
# B.melt <-melt(B,id.vars=c("Country","G"))
# B.melt[,Decisions:=ifelse(value==1,"New rules",ifelse(value==2,"Change rule(s)",ifelse(value==3,"Allowing new members",ifelse(value==4,"Dealing with defaulted loans",ifelse(value==5,"Dealing with members leaving",ifelse(value==6,"Other issues (specify)",ifelse(value==7,"no other decision",NA)))))))]
# B$Decisions<-factor(B$Decisions,levels =c("New rules","Change rule(s)","Allowing new members",
# "Dealing with defaulted loans","Dealing with members leaving","Other issues (specify)","no other decision","Respondents","Percentage"))
# B<-B.melt%>% drop_na() %>% group_by(Country,Decisions,G)  %>% dcast(Decisions~Country+G)
# rbind(B,c("Respondents",colSums(B[,c(2:7)],na.rm = T))) %>% kable()
# per <- B%>%  adorn_percentages('col')
 per[c(1:length(per$Mali_G1)),2:7] <-per[c(1:length(per$Mali_G1)),2:7] %>% signif(digits=3)
 rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```
```{r}
x =M1[,grep("Country|A_29",names(M1)),with =F][,c(1:4)]
 x$G <-"G1"
 x1=M2[,grep("Country|A_27",names(M2)),with =F]#[,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|A_27",names(M3)),with =F]#[,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","New rules","Change rule(s)","Allowing new members","G")
B.melt <-melt(B,id.vars=c("Country","G"))
B<-B.melt %>% drop_na() %>% group_by(Country,G) %>% dcast(variable~Country,fun =sum) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# 30	Who made the decision about {0} ?	

```{r,fig.width =10}
x =M1[,grep("Country|Q_30",names(M1)),with =F][,c(1:15)]
 x$G <-"G1"
 x1=M2[,grep("Country|Q_28",names(M2)),with =F][,c(1:15)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_28",names(M3)),with =F][,c(1:15)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
B.melt<-melt(B,id.vars =c("Country","G"))
B.melt$value[B.melt$value==-1]<-NA
setDT(B.melt)
B.melt<-B.melt %>% drop_na()
B.melt[,variable:=gsub("SEEP_GROUPMEETING 1_","",variable)]
B.melt[,variable:=gsub("_Q_30_S","",variable)]
B.melt[,variable:=gsub("_Q_30","",variable)]
B.melt[,value:=ifelse(value==1,"The chairperson",ifelse(value==2,"The committee",ifelse(value==3,"The entire savings-group (voting)",ifelse(value==4,"Just by discussion, nobody decided",ifelse(value==5,"All requests automatically approved",'Other (specify)')))))]
B.melt %>% ggplot(aes(x =variable,fill =value))+geom_bar(position ='fill')+theme1+scale_fill_manual(values =colors)+labs(title ="	Who made the decision about {0} ?	SEEP-GM-30",x ="Decision")+coord_flip()+facet_wrap(~Country)
kamau %>% kable()
```

# Others Files

```{r}
x =M1[,grep("Country|Q_30",names(M1)),with =F][,c(1,15)]
 x$G <-"G1"
 x1=M2[,grep("Country|Q_28",names(M2)),with =F][,c(1,15)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_28",names(M3)),with =F][,c(1,15)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","test","G")
B %>% drop_na() %>% group_by(Country,test) %>% count()
```









# Q31	Did the group have any conflict or disagreement in the meeting?	

```{r}
x =M1[,grep("Country|Q_31",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_29",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_29",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_31","G")
B[,Conflict:=ifelse(Q_31==1,"Yes, a large disagreement/conflict",ifelse(Q_31==2,"Yes, just small disagreements",ifelse(Q_31==3,"No, I did not notice anything",ifelse(Q_31==4,"Other (specify)",NA))))]
B$Conflict <-factor(B$Conflict,levels =c("Yes, a large disagreement/conflict","Yes, just small disagreements","No, I did not notice anything","Other (specify)","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Conflict,G)  %>% dcast(Conflict~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()

```

# Q32	Was the conflict or disagreement resolved?

```{r}
x =M1[,grep("Country|Q_32",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_30",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_30",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_32","G")
B[,Conflict:=ifelse(Q_32==1,"Yes",ifelse(Q_32==2,"More or less",ifelse(Q_32==3,"No",ifelse(Q_32==4,"Other (specify)",NA))))]
B$Conflict <-factor(B$Conflict,levels =c("Yes","More or less","No","Other (specify)","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Conflict,G)  %>% dcast(Conflict~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# 33	What was the issue?

```{r}
x =M1[,grep("Country|Q_33",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_31",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_31",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Others","G")
B %>% drop_na() %>% group_by(Others) %>% count()
```

# 34	How was it resolved?

```{r}
x =M1[,grep("Country|Q_34",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_32",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_32",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Others","G")
B %>% drop_na() %>% group_by(Others) %>% count()
```

# Q35	At the end of the meeting, how many members had outstanding loans?

```{r,fig.width =10}
x =M1[,grep("Country|Q_35",names(M1)),with =F]#[,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_33",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_33",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
#B[,Q_27:=ifelse(Q_35<0,NA,Q_35)]
names(B)<-c("Country","Q_35","G")
B %>% drop_na() %>% ggplot(aes(x=Country,y =Q_35))+geom_boxplot(fill =colors[1])+labs(title ="At the end of the meeting, how many members had outstanding loans?		SEEP-GM-35",x ="Country",y ="Members with loans")+theme1+scale_fill_manual(values=colors)+scale_y_continuous(breaks=seq(0,60,5))+geom_jitter(alpha = 0.2,color =colors[5])
B$ID<-1:924
xx<-B %>% arrange(B$Q_35)
B$ID<-factor(B$ID,levels = xx$ID)
B %>% ggplot(aes(x =ID,y =Q_35))+geom_bar(stat ="identity",col =colors[1])+facet_wrap(~Country)+scale_fill_manual(values =colors)+theme1+labs(title ="At the end of the meeting, how many members had outstanding loans?		SEEP-GM-35",x ="Country",y ="Members with loans")+scale_y_continuous(breaks=seq(0,60,5))
kamau %>% kable()
```

# Q36	Does the group have a social fund?	

```{r}
x =M1[,grep("Country|Q_36",names(M1)),with =F]#[,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_34",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_34",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_36","G")
B[,Fund:=ifelse(Q_36==1,"Yes",ifelse(Q_36==2,"No",NA))]
B$Fund <-factor(B$Fund,levels =c("Yes","No","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Fund,G) %>% dcast(Fund~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# Q37	How is it funded?	

```{r}
x =M1[,grep("Country|Q_37",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_35",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_35",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_37","G")
B[,Fund:=ifelse(Q_37==1,"Members contribute a fixed amount every meeting",ifelse(Q_37==2,"Members contribute up to a certain amount then contributions are frozen until it drops below that amount.",ifelse(Q_37==3,"Other:",NA)))]
B$Fund <-factor(B$Fund,levels =c("Members contribute a fixed amount every meeting","Members contribute up to a certain amount then contributions are frozen until it drops below that amount.","Other:","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Fund,G) %>% dcast(Fund~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# Q38	What are the conditions to access the social fund?	

```{r}
x =M1[,grep("Country|Q_38",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_36",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_36",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_38","G")
B[,Fund:=ifelse(Q_38==1,"Members borrow with interest",ifelse(Q_38==2,"Members borrow without interest",ifelse(Q_38==3,"Members are given gifts that are not repaid",ifelse(Q_38==4,"Fund is used to support people outside of group",ifelse(Q_38==5,"Other:",NA)))))]
B$Fund <-factor(B$Fund,levels =c("Members borrow with interest","Members borrow without interest","Members are given gifts that are not repaid","Fund is used to support people outside of group","Other:","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Fund,G)  %>% dcast(Fund~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# Q39	What are the criteria for receiving social fund money?	

```{r}
x =M1[,grep("Country|Q_39",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_37",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_37",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_39","G")
B[,Fund:=ifelse(Q_39==1,"Specific list of uses only (such as death, birth, injury)",ifelse(Q_39==2,"Request money for any social need",ifelse(Q_39==3,"Other (specify)",NA)))]
B$Fund <-factor(B$Fund,levels =c("Specific list of uses only (such as death, birth, injury)",
"Request money for any social need","Other (specify)","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Fund,G)  %>% dcast(Fund~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# Q40	What is the balance of the Social Fund?

* Mali exchange rate 0.00169950
* Uganda exchange rate 0.000270226


```{r}
ug =0.0002708606
ml =0.0017068220
x =M1[,grep("Country|Q_40",names(M1)),with =F]#[,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_38",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_38",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_40","G")
B[,Q_40:=ifelse(Q_40<0,NA,Q_40)]
ML <-B[B$Country=="Mali"]
UG <-B[B$Country=="Uganda"]
ML %>% drop_na() %>% ggplot(aes(x =Country,y =Q_40*ml))+geom_boxplot(fill =colors[1])+labs(title ="What is the balance of the Social Fund?		SEEP-GM-40 Mali","Group_meetings",y ="Outstanding Funds in dollars")+theme1+scale_fill_manual(values=colors)+scale_y_continuous(breaks=seq(0,10,1))+geom_jitter(alpha =.2,color = colors[5])
print("Uganda")
UG %>% drop_na() %>% ggplot(aes(x=Country,y =Q_40*ug))+geom_boxplot(fill =colors[1])+labs(title ="What is the balance of the Social Fund?		SEEP-GM-40 Uganda","Group_meetings",y ="Outstanding Funds in dollars")+theme1+scale_fill_manual(values=colors)+scale_y_continuous(breaks=seq(0,100,10))+coord_cartesian(ylim =c(0,100))+geom_jitter(alpha =.2,color = colors[5])
 kamau %>% kable()
```

# Q41	Did any elections take place or get discussed for committee positions?

```{r}
x =M1[,grep("Country|Q_41",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_39",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_39",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_41","G")
B[,Elections:=ifelse(Q_41==1,"No, not mentioned",ifelse(Q_41==2,"Yes, discussed but planned for later",ifelse(Q_41==3,"Yes, elections took place",ifelse(Q_41==4,"Other (specify)",NA))))]
B$Elections <-factor(B$Elections,levels =c("No, not mentioned","Yes, discussed but planned for later","Yes, elections took place","Other (specify)","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Elections,G) %>% dcast(Elections~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# Q44	How was the cash handled?	

```{r}
x =M1[,grep("Country|Q_44",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_42",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_42",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_44","G")
B[,Cash:=ifelse(Q_44==1,"Separate money counter/ separate bookkeeper/ separate treasurer,",ifelse(Q_44==2,"Separate bookkeeper / treasurer",ifelse(Q_44==3,"All done by same person",ifelse(Q_44==4,"Other (specify)",NA))))]
B$Cash <-factor(B$Cash,levels =c("Separate money counter/ separate bookkeeper/ separate treasurer,","Separate bookkeeper / treasurer","All done by same person","Other (specify)","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Cash,G) %>% dcast(Cash~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# Q45	Where was the cash money stored between previous and this meeting?

```{r}
x =M1[,grep("Country|Q_45",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_43",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_43",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_45","G")
B[,Cash:=ifelse(Q_45==1,"In a box with several locks",ifelse(Q_45==2,"In a box with 1 lock",ifelse(Q_45==3,"In another container that could be locked",ifelse(Q_45==4,"In another container locked with one lock",ifelse(Q_45==5,"No money was left (all lent out)",ifelse(Q_45==6,"Other (specify)",NA))))))]
B$Cash <-factor(B$Cash,levels =c("In a box with several locks","In a box with 1 lock","In another container that could be locked","In another container locked with two or more locks","In another container locked with one lock","No money was left (all lent out)","Other (specify)","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Cash,G)  %>% dcast(Cash~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# Q46	Did any of the money from the group get stored in a (bank-)account or mobile money account between last and this meeting?	

```{r}
x =M1[,grep("Country|Q_46",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_44",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_44",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_46","G")
B[,Cash:=ifelse(Q_46==1,"Yes, all excess cash was stored in the account",ifelse(Q_46==2,"Yes, some excess cash was stored in the account",ifelse(Q_46==3,"No, the excess cash was too little",ifelse(Q_46==4,"No, it was not considered",ifelse(Q_46==5,"Other (specify)",ifelse(Q_46==6,"I don’t know",ifelse(Q_46==7,"I don’t want to answer",NA)))))))]
B$Cash <-factor(B$Cash,levels =c("Yes, all excess cash was stored in the account","Yes, some excess cash was stored in the account","No, the excess cash was too little","No, it was not considered","Other (specify)","I don’t know","I don’t want to answer","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Cash,G)  %>% dcast(Cash~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# Q47	Did any of the money from the group get stored in different places, e.g. different group members?

```{r}
x =M1[,grep("Country|Q_47",names(M1)),with =F][,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_45",names(M2)),with =F][,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_45",names(M3)),with =F][,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_47","G")
B[,Cash:=ifelse(Q_47==1,"All in one place",ifelse(Q_47==2,"In two places",ifelse(Q_47==3,"Other (specify)",ifelse(Q_47==4,"I don’t know",NA))))]
B$Cash <-factor(B$Cash,levels =c("All in one place","In two places","Other (specify)","I don’t know","Respondents","Percentage"))
B<-B%>% drop_na() %>% group_by(Country,Cash,G) %>% dcast(Cash~Country) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()
```

# Q48	How many members attended in total?	 (Multiple Selection)

```{r,fig.width=20,fig.height=15}
library(plotly)
x =M1[,grep("Country|T_48",names(M1)),with =F]#[,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|T_46",names(M2)),with =F]#[,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|T_46",names(M3)),with =F]#[,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","number attended personallly",	"represented by someone else (person stayed)",	"Rep. by someone with the savings (didnt stay)",	"sent their money through other group-member",	"had announced they would be absent",	"had a known emergency and were absent",	"absent for unknown reason and not represented","G")
B.melt<-melt(B,id.vars =c("Country","G"))
B.melt$variable <-factor(B.melt$variable,levels =c("number attended personallly",	"represented by someone else (person stayed)",	"Represented by someone with the savings (person did not stay)",	"sent their money through other group-member",	"had announced they would be absent",	"had a known emergency and were absent",	"absent for unknown reason and not represented"))
UG<-B.melt[B.melt$Country=="Uganda"]
ML<-B.melt[B.melt$Country=="Mali"]
h<- UG %>% drop_na() %>% ggplot(aes(x=variable,y =value))+geom_boxplot(fill =colors[1])+labs(title ="How many members attended in total? SEEP-GM-48 \n Uganda",x ="Absent Members",y ="Members")+theme1+scale_fill_manual(values=colors)+coord_flip()+theme(axis.title = element_text(size = 20))+scale_y_continuous(breaks =seq(0,40,5))+geom_jitter(alpha = 0.2,color =colors[5])
#(h)
h
print("Mali")
y<-ML%>% drop_na() %>% ggplot(aes(x=variable,y =value))+geom_boxplot(fill =colors[1])+labs(title ="How many members attended in total? SEEP-GM-48 \n Mali",x ="Absent Members",y ="Members")+theme1+scale_fill_manual(values=colors)+coord_flip()+theme(axis.title = element_text(size = 20))+scale_y_continuous(breaks =seq(0,40,5))+geom_jitter(alpha =0.2,color =colors[5])
y
#(y)
 B %>% drop_na() %>% group_by(Country,G) %>% dcast(Country~G) %>% kable()
```
```{r}
# B.melt %>% drop_na() %>% ggplot(aes(x=Country,y =value,fill =variable))+geom_bar(stat ='identity',position ="fill")+theme1+scale_fill_manual(values =colors)
```

# Q49	How many members arrived after meeting started?


```{r}
x =M1[,grep("Country|Q_49",names(M1)),with =F]#[,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|Q_47",names(M2)),with =F]#[,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_47",names(M3)),with =F]#[,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-c("Country","Q_49","G")
B %>% drop_na() %>% ggplot(aes(x=Country,y =Q_49))+geom_boxplot(fill =colors[1])+labs(title ="How many members arrived after meeting started? SEEP-GM-49",x ="Absent Members",y ="Members")+theme1+scale_fill_manual(values=colors)+scale_y_continuous(breaks =seq(0,25,5))+geom_jitter(alpha =0.2,color =colors[5])
B$ID<-1:924
xx<-B %>% arrange(B$Q_49)
B$ID<-factor(B$ID,levels = xx$ID)
x<-B %>% ggplot(aes(x =ID,y =Q_49))+geom_bar(stat ="identity",col =colors[1])+facet_wrap(~Country)+scale_fill_manual(values =colors)+theme1+labs(title ="At the end of the meeting, how many members had outstanding loans?		SEEP-GM-35",x ="Group_meetings",y ="Members with loans")+scale_y_continuous(breaks=seq(0,20,2))+theme(axis.text.x = element_blank())
x
#(x)
kamau %>% kable()
```

# Q50	Has the group experienced any of the following since last meeting up to end of this meeting?	(Multiple Selection)

```{r,fig.width =10}
x =M1[,grep("Country|T_50",names(M1)),with =F]#[,c(1:2)]
x$G <-"G1"
x1=M2[,grep("Country|T_48",names(M2)),with =F]#[,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|T_48",names(M3)),with =F]#[,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA
names(B)<-	c("Country","Lost money through theft or fraud from a committee member","Lost money through theft by outsider",	"Member(s) dropout",	"Death of a member",	"Poor administration",	"Dishonesty by members causing loss of money",	"Members paying loan late",	"Members not repaying loan",	"Errors in records in ledger or passbook",	"Election new committee",
	"Elections but same committee appointed",	"Lock box broken into",	"Lock box stolen/lost",	"Money deposited in bank-account",
	"Money lost/stolen on the way to or from bank-account",	"Disputes between members",	"Disputes between committee and members",	"Disputes amongst committee members","G")
B.melt<-melt(B,id.vars =c("Country","G"))
B.melt[,Exp:=ifelse(value==1,"Yes",ifelse(value==2,"No",ifelse(value==3,"Don't know",NA)))]
B.melt$variable <-factor(B.melt$variable,levels =c("Lost money through theft or fraud from a committee member","Lost money through theft by outsider",	"Member(s) dropout",	"Death of a member",	"Poor administration",	"Dishonesty by members causing loss of money",	"Members paying loan late",	"Members not repaying loan",	"Errors in records in ledger or passbook",	"Election new committee",
	"Elections but same committee appointed",	"Lock box broken into",	"Lock box stolen/lost",	"Money deposited in bank-account",
	"Money lost/stolen on the way to or from bank-account",	"Disputes between members",	"Disputes between committee and members",	"Disputes amongst committee members"))
B.melt$Exp<-factor(B.melt$Exp,levels =c("Yes","No","Don't know"))
UG =B.melt[B.melt$Country=="Uganda"]
ML =B.melt[B.melt$Country=="Mali"]
h<-UG %>% drop_na() %>% ggplot(aes(x=variable,fill=Exp))+geom_bar(position ="fill")+coord_flip()+theme1+scale_fill_manual(values =colors)+labs(title ="Has the group experienced any of the following since \n last meeting up to end of this meeting? SEEP-GM-50 \n Uganda")+theme(axis.title = element_text(size = 14))
h
#(h)
h<-ML %>% drop_na() %>% ggplot(aes(x=variable,fill=Exp))+geom_bar(position ="fill")+coord_flip()+theme1+scale_fill_manual(values =colors)+labs(title ="Has the group experienced any of the following since \n last meeting up to end of this meeting? SEEP-GM-50 \n Mali")+theme(axis.title = element_text(size = 14))
h
kamau %>% kable()
```

# Q51	Was any of the following used at the group-meeting?	(Multiple Choice)

```{r}
x =M1[,grep("Country|A_51",names(M1)),with =F]#[,c(1:2)]

x$G <-"G1"
x1=M2[,grep("Country|A_49",names(M2)),with =F]#[,c(1:2)]
x1$G <-"G2"
x2 =M3[,grep("Country|Q_49",names(M3)),with =F]#[,c(1:2)]
x2$G <-"G3"
B <-rbind(x,x1,use.names=FALSE)
B<-rbind(B,x2,use.names=FALSE)
B[B$Country=="-"]<-NA

names(B)<-c("Country","Calculator on phone","Separate calculator","App on phone including e-recording","Tablet or computer","Mobile money","eWallet","None","G")
B.melt <-melt(B,id.vars =c("Country","G"))
B.melt$value[B.melt$value==-1]<-0
#B.melt[,Tech:=ifelse(value==1,"Calculator on phone",ifelse(value==2,"Separate calculator",ifelse(value==3,"App on phone including e-recording",ifelse(value==4,"Tablet or computer",ifelse(value==5,"Mobile money",ifelse(value==6,"eWallet",ifelse(value==7,"None",NA)))))))]
B.melt$variable<-factor(B.melt$variable,levels =c("Calculator on phone","Separate calculator","App on phone including e-recording","Tablet or computer","Mobile money","eWallet","None","Respondents","Percentage"))
B<-B.melt %>% drop_na() %>% group_by(Country,variable,G)  %>% dcast(variable~Country,fun =sum) %>% mutate(Uganda =Uganda/3,Mali =Mali/3)
rbind(B,c("Respondents",colSums(B[,c(2:3)],na.rm = T))) %>% kable()
per <- B%>%  adorn_percentages('col')
per[c(1:length(per$Mali_G1)),2:3] <-per[c(1:length(per$Mali_G1)),2:3] %>% signif(digits=3)
rbind(per,c("Percentage",c(1,1,1,1,1,1)))  %>% kable()


```

